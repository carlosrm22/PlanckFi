<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover" />
    
    <!-- PWA Meta Tags - iOS 18 Optimized -->
    <meta name="description" content="PlanckFi - Tu app de finanzas personales con IA, diseÃ±o nativo iOS 18 y control total de tus gastos" />
    <meta name="theme-color" content="#0A84FF" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="PlanckFi" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="msapplication-TileColor" content="#0A84FF" />
    <meta name="msapplication-tap-highlight" content="no" />
    
    <!-- iOS 18 Specific Meta Tags -->
    <meta name="apple-touch-fullscreen" content="yes" />
    <meta name="format-detection" content="telephone=no, email=no, address=no" />
    <meta name="apple-mobile-web-app-orientations" content="portrait" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    
    <!-- Dynamic Island Support -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover, viewport-fit=cover" />
    
    <!-- Manifest -->
    <link rel="manifest" href="/manifest.json" />
    
    <!-- iOS Icons - iPhone 17 Optimized -->
    <link rel="apple-touch-icon" href="/icons/icon-180x180.png" />
    <link rel="apple-touch-icon" sizes="152x152" href="/icons/icon-152x152.png" />
    <link rel="apple-touch-icon" sizes="167x167" href="/icons/icon-167x167.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/icon-180x180.png" />
    <link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png" />
    <link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png" />
    
    <!-- Splash Screens - iPhone 17 & iOS 18 -->
    <link rel="apple-touch-startup-image" href="/splash/apple-splash-2048-2732.png" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2)" />
    <link rel="apple-touch-startup-image" href="/splash/apple-splash-1668-2388.png" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2)" />
    <link rel="apple-touch-startup-image" href="/splash/apple-splash-1536-2048.png" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2)" />
    <link rel="apple-touch-startup-image" href="/splash/apple-splash-1125-2436.png" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3)" />
    <link rel="apple-touch-startup-image" href="/splash/apple-splash-1242-2688.png" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3)" />
    <link rel="apple-touch-startup-image" href="/splash/apple-splash-750-1334.png" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2)" />
    <link rel="apple-touch-startup-image" href="/splash/apple-splash-640-1136.png" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2)" />
    
    <!-- iPhone 17 Pro Max (430x932) -->
    <link rel="apple-touch-startup-image" href="/splash/apple-splash-1290-2796.png" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3)" />
    
    <!-- Preconnect para mejor performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    
    <!-- SF Pro Font - iOS 18 System Font -->
    <link rel="preload" href="https://fonts.cdnfonts.com/css/sf-pro-display" as="style" onload="this.onload=null;this.rel='stylesheet'" />
    <noscript><link rel="stylesheet" href="https://fonts.cdnfonts.com/css/sf-pro-display" /></noscript>
    
    <!-- iOS 18 CSS Variables for Safe Areas -->
    <style>
      :root {
        --safe-area-inset-top: env(safe-area-inset-top);
        --safe-area-inset-bottom: env(safe-area-inset-bottom);
        --safe-area-inset-left: env(safe-area-inset-left);
        --safe-area-inset-right: env(safe-area-inset-right);
        --dynamic-island-height: calc(var(--safe-area-inset-top) + 8px);
      }
      
      /* iOS 18 System Font Stack */
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Helvetica Neue', sans-serif;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        text-rendering: optimizeLegibility;
      }
      
      /* iOS 18 Scroll Behavior */
      html {
        scroll-behavior: smooth;
        overscroll-behavior: contain;
      }
      
      /* iOS 18 Touch Actions */
      * {
        -webkit-tap-highlight-color: transparent;
        touch-action: manipulation;
      }
      
      /* iOS 18 Focus Styles */
      *:focus {
        outline: 2px solid #0A84FF;
        outline-offset: 2px;
      }
      
      /* iOS 18 Selection */
      ::selection {
        background-color: #0A84FF;
        color: white;
      }
      
      /* iOS 18 Loading State */
      .ios-loading {
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
        background-size: 200% 100%;
        animation: iosShimmer 1.5s ease-in-out infinite;
      }
      
      @keyframes iosShimmer {
        0% { background-position: -200% 0; }
        100% { background-position: 200% 0; }
      }
    </style>
    
    <title>PlanckFi - Finanzas Inteligentes</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
    
    <!-- Service Worker Registration - iOS 18 Optimized -->
    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/sw.js', {
            scope: '/',
            updateViaCache: 'none'
          })
          .then((registration) => {
            console.warn('SW registered: ', registration);
            
            // Check for updates
            registration.addEventListener('updatefound', () => {
              const newWorker = registration.installing;
              newWorker.addEventListener('statechange', () => {
                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                  // New content available
                  console.warn('New content available');
                }
              });
            });
          })
          .catch((registrationError) => {
            console.error('SW registration failed: ', registrationError);
          });
        });
      }
      
      // PWA Install Prompt - iOS 18
      let deferredPrompt;
      window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
        console.warn('PWA install prompt disponible');
        
        // Trigger haptic feedback if available
        if (navigator.vibrate) {
          navigator.vibrate([30, 10, 30]);
        }
      });
      
      // iOS specific optimizations
      if (navigator.userAgent.match(/iPhone|iPad|iPod/)) {
        // Disable zoom on double tap
        let lastTouchEnd = 0;
        document.addEventListener('touchend', (event) => {
          const now = (new Date()).getTime();
          if (now - lastTouchEnd <= 300) {
            event.preventDefault();
          }
          lastTouchEnd = now;
        }, false);
        
        // Optimize viewport for iOS
        const viewport = document.querySelector('meta[name=viewport]');
        if (viewport) {
          viewport.setAttribute('content', 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover');
        }
        
        // Add iOS specific classes
        document.documentElement.classList.add('ios-device');
      }
      
      // Performance monitoring
      if ('performance' in window) {
        window.addEventListener('load', () => {
          setTimeout(() => {
            const perfData = performance.getEntriesByType('navigation')[0];
            console.warn('Page load time:', perfData.loadEventEnd - perfData.loadEventStart, 'ms');
          }, 0);
        });
      }
    </script>
  </body>
</html> 